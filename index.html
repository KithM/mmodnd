<!DOCTYPE html>
<html>
<head>
  <title>D&D Helper</title>
  <script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-app.js";
    import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-database.js";
    // TODO: Add SDKs for Firebase products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries

    // Your web app's Firebase configuration
    const firebaseConfig = {
        apiKey: "AIzaSyAJU-G5AsPKWO6_VsdB0LPmTww1YoII9Uo",
        authDomain: "mmo-ttrpg.firebaseapp.com",
        projectId: "mmo-ttrpg",
        storageBucket: "mmo-ttrpg.appspot.com",
        messagingSenderId: "232247749266",
        appId: "1:232247749266:web:87492bf9831f6c90d4d44b"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    // DM Side: Sending Enemies
    function sendEnemies() {
      const type = document.getElementById("enemy-type").value;
      const count = document.getElementById("enemy-count").value;
      const enemies = { type, count };
      set(ref(db, 'game/enemies'), enemies);
    }

    // Attach sendEnemies to the window object
    window.sendEnemies = sendEnemies;

    // Player Side: Receiving Enemies
    const enemyRef = ref(db, 'game/enemies');
    onValue(enemyRef, (snapshot) => {
      const enemies = snapshot.val();
      const alertBox = document.getElementById("alert-box");
      if (enemies) {
        alertBox.innerHTML = `New enemies incoming: ${enemies.count} ${enemies.type}`;
      }
    });
  </script>
</head>
<body>
  <h1>D&D Helper</h1>

  <!-- DM Side -->
  <h2>For Dungeon Master</h2>
  <label for="enemy-type">Enemy Type:</label>
  <input type="text" id="enemy-type">
  <label for="enemy-count">Count:</label>
  <input type="number" id="enemy-count">
  <button onclick="sendEnemies()">Send Enemies</button>

  <!-- Player Side -->
  <h2>For Players</h2>
  <div id="alert-box"></div>
</body>
</html>